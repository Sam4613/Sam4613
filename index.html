<!DOCTYPE html>
<html>
  <head>
    <title>Markerless AR with A-Frame, AR.js, and Three.js</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r123/three.min.js"></script>
  </head>
  <body>
    <a-scene embedded arjs>
      <a-assets>
        <a-asset-item id="my-model" src="https://cdn.glitch.com/60427e9c-58d3-42da-b663-e7dbbc61de8c%2Fflamingo.glb?v=1588452801839"></a-asset-item>
      </a-assets>

      <a-marker-camera preset="hiro">
        <a-entity id="model" gltf-model="#my-model" scale="0.1 0.1 0.1" position="0 0 -10"></a-entity>
      </a-marker-camera>
    </a-scene>

    <script>
      AFRAME.registerComponent('resize-on-walk', {
        init: function () {
          this.el.addEventListener('componentchanged', (evt) => {
            if (evt.detail.name === 'position') {
              const distance = this.el.object3D.position.distanceTo(this.el.sceneEl.camera.el.object3D.position);
              const newScale = 1 - distance / 5;
              this.el.setAttribute('scale', `${newScale} ${newScale} ${newScale}`);
            }
          });
        }
      });

      AFRAME.registerComponent('human-level', {
        init: function () {
          this.el.object3D.position.y = this.el.object3D.position.y - 1.6;
        }
      });

      document.querySelector('#model').setAttribute('resize-on-walk', '');
      document.querySelector('#model').setAttribute('human-level', '');
    </script>
  </body>
</html>
